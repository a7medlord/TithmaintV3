@model List<CloudApp.Models.ManpulateModel.ModelView>

@{
    ViewData["Title"] = "الرئيسية";
}


<div class="row">

    <div class="col-md-2">
        <div class="panel minimal panel-primary">
            <div class="panel-heading clearfix">
                <div class="panel-title">معاملات تحت التثمين</div>
                <ul class="panel-tool-options">
                    <li class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#" aria-expanded="false"><i class="icon-cog"></i></a>
                        <ul class="dropdown-menu dropdown-menu-right">
                            <li><a href="#"><i class="icon-arrows-ccw"></i> Update data</a></li>
                            <li><a href="#"><i class="icon-list"></i> Detailed log</a></li>
                            <li><a href="#"><i class="icon-chart-pie"></i> Statistics</a></li>
                            <li class="divider"></li>
                            <li><a href="#"><i class="icon-cancel"></i> Clear list</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
            <!-- panel body -->
            <div class="panel-body">
                <div class="row col-with-divider">
                    <div class="col-xs-10 text-center stack-order">
                        <h1 class="no-margins">@ViewBag.thmin</h1>
                        <small>معاملة</small>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div class="col-md-2">
        <div class="panel minimal panel-primary">
            
            <div class="panel-heading clearfix">
                <div class="panel-title">معاملات للتدقيق</div>
                <ul class="panel-tool-options">
                    <li class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#" aria-expanded="false"><i class="icon-cog"></i></a>
                        <ul class="dropdown-menu dropdown-menu-right">
                            <li><a href="#"><i class="icon-arrows-ccw"></i> Update data</a></li>
                            <li><a href="#"><i class="icon-list"></i> Detailed log</a></li>
                            <li><a href="#"><i class="icon-chart-pie"></i> Statistics</a></li>
                            <li class="divider"></li>
                            <li><a href="#"><i class="icon-cancel"></i> Clear list</a></li>
                        </ul>
                    </li>
                </ul>
            </div>

            <!-- panel body -->
            <div class="panel-body">
                <div class="row col-with-divider">
                    <div class="col-xs-10 text-center stack-order">
                        <h1 class="no-margins">@ViewBag.aduit</h1>
                        <small>معاملة</small>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div class="col-md-2">
        <div class="panel minimal panel-primary">
            
            <div class="panel-heading clearfix">
                <div class="panel-title">معاملات للاعتماد</div>
                <ul class="panel-tool-options">
                    <li class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#" aria-expanded="false"><i class="icon-cog"></i></a>
                        <ul class="dropdown-menu dropdown-menu-right">
                            <li><a href="#"><i class="icon-arrows-ccw"></i> Update data</a></li>
                            <li><a href="#"><i class="icon-list"></i> Detailed log</a></li>
                            <li><a href="#"><i class="icon-chart-pie"></i> Statistics</a></li>
                            <li class="divider"></li>
                            <li><a href="#"><i class="icon-cancel"></i> Clear list</a></li>
                        </ul>
                    </li>
                </ul>
            </div>

            <!-- panel body -->
            <div class="panel-body">
                <div class="row col-with-divider">
                    <div class="col-xs-10 text-center stack-order">
                        <h1 class="no-margins">@ViewBag.approved</h1>
                        <small>معاملة</small>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="panel minimal panel-primary">
            <div class="panel-heading clearfix">
                <div class="panel-title">المعاملات المعتمدة</div>
                <ul class="panel-tool-options">
                    <li class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#" aria-expanded="false"><i class="icon-cog"></i></a>
                        <ul class="dropdown-menu dropdown-menu-right">
                            <li><a href="#"><i class="icon-arrows-ccw"></i> Update data</a></li>
                            <li><a href="#"><i class="icon-list"></i> Detailed log</a></li>
                            <li><a href="#"><i class="icon-chart-pie"></i> Statistics</a></li>
                            <li class="divider"></li>
                            <li><a href="#"><i class="icon-cancel"></i> Clear list</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
            <!-- panel body -->
            <div class="panel-body">
                <div class="row col-with-divider">
                    <div class="col-xs-10 text-center stack-order">
                        <h1 class="no-margins">@ViewBag.approveded</h1>
                        <small>معاملة</small>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="panel minimal panel-primary">
            <div class="panel-heading clearfix">
                <div class="panel-title">معاملات اقفلت ماليآ</div>
                <ul class="panel-tool-options">
                    <li class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#" aria-expanded="false"><i class="icon-cog"></i></a>
                        <ul class="dropdown-menu dropdown-menu-right">
                            <li><a href="#"><i class="icon-arrows-ccw"></i> Update data</a></li>
                            <li><a href="#"><i class="icon-list"></i> Detailed log</a></li>
                            <li><a href="#"><i class="icon-chart-pie"></i> Statistics</a></li>
                            <li class="divider"></li>
                            <li><a href="#"><i class="icon-cancel"></i> Clear list</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
            <!-- panel body -->
            <div class="panel-body">
                <div class="stack-order">
                    <h1 class="no-margins">@ViewBag.financ</h1>
                    <small> معاملة</small>
                </div>
                <div class="bar-chart-icon"></div>
            </div>
        </div>
    </div>

</div>


<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3>معاملات للتعميد</h3>
            </div>
            <div class="panel-body">

                <ul class="comments-list removeable-list">

                    @foreach (var item in Model)
                    {
                        <li>
                            <div class="comment-head">
                                نتائج معاينه وتقيم رقم @Html.DisplayFor(modelItem => item.Id) والمؤرخه في تاريخ @Html.DisplayFor(modelItem => item.DateOfBegin)الواقعة في مدينه @Html.DisplayFor(modelItem => item.City) بحي @Html.DisplayFor(modelItem => item.Gada)
                            </div>
                
                            <div class="comment-text">
                                <p> تعميد المستندات والأدخال</p>
                            </div>
                            <div class="comment-footer">
                                <input id="idmodel" value="@Html.DisplayFor(modelItem => item.Id)" type="hidden" />
                                <input id="typemodel" value="@Html.DisplayFor(modelItem => item.type)" type="hidden" />

                                <button onclick="dojob(this)" class="btn btn-sm btn-success">تعميد</button>
                                
                                <button onclick="dojob2(this)" class="btn btn-sm btn-red">تفاصيل</button>
                            </div>
                            <a href="#/" class="remove"><img src="~/images/icon-close.png" alt="Remove" title="Remove"></a>
                        </li>

                    }


                </ul>
            </div>
        </div>
    </div>
</div>


<div class="row">
    <div class="col-lg-6">
        <div class="panel panel-default">
            <div class="panel-heading no-border clearfix">
                <h3 class="panel-title">احصائيات المعاملات الاكثر نشاطآ</h3>
                <ul class="panel-tool-options">
                    <li class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#" aria-expanded="false"><i class="icon-cog icon-2x"></i></a>
                        <ul class="dropdown-menu dropdown-menu-right">
                            <li><a href="#"><i class="icon-arrows-ccw"></i> Update data</a></li>
                            <li><a href="#"><i class="icon-list"></i> Detailed log</a></li>
                            <li><a href="#"><i class="icon-chart-pie"></i> Statistics</a></li>
                            <li class="divider"></li>
                            <li><a href="#"><i class="icon-cancel"></i> Clear list</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
            <!-- panel body -->
            <div class="panel-body">
                <div class="canvas-chart has-doughnut-legend">
                    <canvas id="doughnutChart" width="408" height="300"></canvas>
                </div>
                <div class="height-13"></div>
            </div>
        </div>
    </div>

    <div class="col-lg-6">
        <div class="panel panel-default">
            <div class="panel-heading no-border clearfix">
                <h3 class="panel-title">احصائيات المعاملات الاكثر دخلا</h3>
                <ul class="panel-tool-options">
                    <li class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#" aria-expanded="false"><i class="icon-cog icon-2x"></i></a>
                        <ul class="dropdown-menu dropdown-menu-right">
                            <li><a href="#"><i class="icon-arrows-ccw"></i> Update data</a></li>
                            <li><a href="#"><i class="icon-list"></i> Detailed log</a></li>
                            <li><a href="#"><i class="icon-chart-pie"></i> Statistics</a></li>
                            <li class="divider"></li>
                            <li><a href="#"><i class="icon-cancel"></i> Clear list</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
            <!-- panel body -->
            <div class="panel-body">
                <div class="canvas-chart has-doughnut-legend">
                    <canvas id="doughnutChart1" width="408" height="300"></canvas>
                </div>
                <div class="height-13"></div>
            </div>
        </div>
    </div>
    
  
</div>

<div class="row">
    
    <div id="maptest" style="width: 90%; height: 400px; margin-right: 5%">

    </div>

</div>

@section scripts
{
    <script src="~/FrameWork/js/plugins/flot/jquery.flot.min.js"></script>
    <script src="~/FrameWork/js/plugins/flot/jquery.flot.tooltip.min.js"></script>
    <script src="~/FrameWork/js/plugins/flot/jquery.flot.resize.min.js"></script>
    <script src="~/FrameWork/js/plugins/flot/jquery.flot.selection.min.js"></script>
    <script src="~/FrameWork/js/plugins/flot/jquery.flot.pie.min.js"></script>
    <script src="~/FrameWork/js/plugins/flot/jquery.flot.time.min.js"></script>
    <script src="~/FrameWork/js/plugins/chartjs/Chart.min.js"></script>

    <script>
        alert("@DateTime.Now.ToString()");
        $(document).ready(function() {

            chart1();
            chart2();

        });

        function chart1() {
            var doughnutData = [
                {
                    value: @ViewBag.smaple3,
                    color: "#2bbfba",
                    highlight: "#1fb3ae",
                    label: "عام الشركات"
                },
                {
                    value: @ViewBag.smaple1,
                    color: "#00b8ce",
                    highlight: "#00acc2",
                    label: "الرياض الضمانات والتوثيق"
                },
                {
                    value: @ViewBag.smaple2,
                    color: "#e5e8eb",
                    highlight: "#d9dcdf",
                    label: "الرياض افراد"
                }
            ];

            var doughnutOptions = {
                segmentShowStroke: true,
                segmentStrokeColor: "#fff",
                segmentStrokeWidth: 4,
                percentageInnerCutout: 60, // This is 0 for Pie charts
                animationSteps: 100,
                animationEasing: "easeOutBounce",
                animateRotate: true,
                animateScale: false,
                responsive: true,
                //String - A legend template
                legendTemplate:
                    "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<segments.length; i++){%><li><span style=\"background-color:<%=segments[i].fillColor%>\"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>"
            };

            var canvas = document.getElementById("doughnutChart");
            var helpers = Chart.helpers;
            //var ctx = document.getElementById("doughnutChart").getContext("2d");
            var moduleDoughnut = new Chart(canvas.getContext("2d")).Doughnut(doughnutData, doughnutOptions);
            var legendHolder = document.createElement('div');
            legendHolder.innerHTML = moduleDoughnut.generateLegend();

            helpers.each(legendHolder.firstChild.childNodes,
                function(legendNode, index) {
                    helpers.addEvent(legendNode,
                        'mouseover',
                        function() {
                            var activeSegment = moduleDoughnut.segments[index];
                            activeSegment.save();
                            activeSegment.fillColor = activeSegment.highlightColor;
                            moduleDoughnut.showTooltip([activeSegment]);
                            activeSegment.restore();
                        });
                });

            helpers.addEvent(legendHolder.firstChild,
                'mouseout',
                function() {
                    moduleDoughnut.draw();
                });
            canvas.parentNode.parentNode.appendChild(legendHolder.firstChild);
        }

        function chart2() {
            var doughnutData = [
                {
                    value: @ViewBag.fsmaple3,
                    color: "#2bbfba",
                    highlight: "#1fb3ae",
                    label: "عام الشركات"
                },
                {
                    value: @ViewBag.fsmaple1,
                    color: "#00b8ce",
                    highlight: "#00acc2",
                    label: "الرياض الضمانات والتوثيق"
                },
                {
                    value: @ViewBag.fsmaple2,
                    color: "#e5e8eb",
                    highlight: "#d9dcdf",
                    label: "الرياض افراد"
                }
            ];

            var doughnutOptions = {
                segmentShowStroke: true,
                segmentStrokeColor: "#fff",
                segmentStrokeWidth: 4,
                percentageInnerCutout: 60, // This is 0 for Pie charts
                animationSteps: 100,
                animationEasing: "easeOutBounce",
                animateRotate: true,
                animateScale: false,
                responsive: true,
                //String - A legend template
                legendTemplate:
                    "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<segments.length; i++){%><li><span style=\"background-color:<%=segments[i].fillColor%>\"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>"
            };

            var canvas = document.getElementById("doughnutChart1");
            var helpers = Chart.helpers;
            //var ctx = document.getElementById("doughnutChart").getContext("2d");
            var moduleDoughnut = new Chart(canvas.getContext("2d")).Doughnut(doughnutData, doughnutOptions);
            var legendHolder = document.createElement('div');
            legendHolder.innerHTML = moduleDoughnut.generateLegend();

            helpers.each(legendHolder.firstChild.childNodes,
                function(legendNode, index) {
                    helpers.addEvent(legendNode,
                        'mouseover',
                        function() {
                            var activeSegment = moduleDoughnut.segments[index];
                            activeSegment.save();
                            activeSegment.fillColor = activeSegment.highlightColor;
                            moduleDoughnut.showTooltip([activeSegment]);
                            activeSegment.restore();
                        });
                });

            helpers.addEvent(legendHolder.firstChild,
                'mouseout',
                function() {
                    moduleDoughnut.draw();
                });
            canvas.parentNode.parentNode.appendChild(legendHolder.firstChild);
        }

        function mapwork() {
            var mapProp = {
                center: new google.maps.LatLng(51.508742, -0.120850),
                zoom: 18
            };
            map = new google.maps.Map(document.getElementById("maptest"), mapProp);
            //var myLatLng = { lat: parseFloat($("#Latute").val()), lng: parseFloat($("#Longtute").val()) };
            //var marker = new google.maps.Marker({
            //    position: myLatLng,
            //    map: map,
            //    title: 'موقع العقار'
            //});


            map.addListener('center_changed', function () {
                var obj = map.getCenter();
                $("#Latute").val(obj.lat());
                $("#Longtute").val(obj.lng());

            });


            geocoder = new google.maps.Geocoder;
            infowindowc = new google.maps.InfoWindow;

            var input = document.getElementById('pac-input');
            var searchBox = new google.maps.places.SearchBox(input);

            map.addListener('bounds_changed',
                function () {
                    searchBox.setBounds(map.getBounds());
                });

            var markers = [];
            // Listen for the event fired when the user selects a prediction and retrieve
            // more details for that place.
            searchBox.addListener('places_changed',
                function () {
                    var places = searchBox.getPlaces();

                    if (places.length == 0) {
                        return;
                    }

                    // Clear out the old markers.
                    markers.forEach(function (marker) {
                        marker.setMap(null);
                    });
                    markers = [];

                    // For each place, get the icon, name and location.
                    var bounds = new google.maps.LatLngBounds();
                    places.forEach(function (place) {
                        if (!place.geometry) {
                            console.log("Returned place contains no geometry");
                            return;
                        }
                        var icon = {
                            url: place.icon,
                            size: new google.maps.Size(71, 71),
                            origin: new google.maps.Point(0, 0),
                            anchor: new google.maps.Point(17, 34),
                            scaledSize: new google.maps.Size(25, 25)
                        };

                        // Create a marker for each place.
                        markers.push(new google.maps.Marker({
                            map: map,
                            icon: icon,
                            title: place.name,
                            position: place.geometry.location
                        }));

                        if (place.geometry.viewport) {
                            // Only geocodes have viewport.
                            bounds.union(place.geometry.viewport);
                        } else {
                            bounds.extend(place.geometry.location);
                        }
                    });
                    map.fitBounds(bounds);
                });

        }


        // add new behavire
        function dojob(e) {
            var ids = $(e).siblings("#idmodel").val();
            var type = $(e).siblings("#typemodel").val();
 
            if (confirm("هل انت متاكد من أجراء العملية ؟")) {
                switch (type) {
                case "1":
                    $.post("Treatments/EditAprove/" + ids,
                        {
                    
                        },
                        function(data, status) {
                            if (status == "success") {
                                $(e).parents("li").fadeOut("slow");
                            }
                        });
                    break;
                case "2":
                    $.post("R1Smaple/EditAprove/" + ids,
                        {
                    
                        },
                        function(data, status) {
                            if (status == "success") {
                                $(e).parents("li").fadeOut("slow");
                            }
                        });
                    break;
                case "3":
                    $.post("R2Smaple/EditAprove/" + ids,
                        {
                    
                        },
                        function(data, status) {
                            if (status == "success") {
                                $(e).parents("li").fadeOut("slow");
                            }
                        });
                    break;
                default:
                }
            }

        }


        function dojob2(e) {
            var ids = $(e).siblings("#idmodel").val();
            var type = $(e).siblings("#typemodel").val();
            
            switch (type) {
            case "1":
                location.href = "/Treatments/Edit/" + ids;
        
                break;
            case "2":

                location.href = "/R1Smaple/Edit/" + ids;

                break;
            case "3":
                location.href = "/R2Smaple/Edit/" + ids;
                break;
            default:
            }
 

        }


    </script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDi_nL0Zh0BYDb5iZTndmJCr-uHjd1Pvhs&language=ar&libraries=places&callback=mapwork"></script>
}

